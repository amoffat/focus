{"name":"Focus.py","body":"Focus.py helps you keep focused by applying schedulable firewall rules\r\nto distracting websites.  An example firewall rule looks like this:\r\n\r\n``` python\r\ndef domain_reddit_com(dt):\r\n    return dt.hour == 21 # allow from 9-10pm\r\n```\r\n\r\nStarting\r\n========\r\n\r\n### Linux\r\n\r\nAdd the following line to the top of your `/etc/resolv.conf`, *before* any\r\nother nameservers:\r\n\r\n    nameserver 127.0.0.1\r\n\r\n### Mac OS X\r\n\r\nGo to `System Preferences -> Network -> Advanced -> DNS` and add `127.0.0.1`\r\nas your DNS server.\r\n\r\n-----\r\n\r\nNow start Focus:\r\n\r\n    sudo python focus.py &\r\n    \r\n    \r\nFiltering Domains\r\n=================\r\n\r\nFirewall rules involving schedules and timeframes can get complicated fast.\r\nFor this reason, the scheduling specification is pure Python, so you can make\r\nyour filtering rules as simple or as complex as you want.\r\n\r\nThe default filter rules is created on first startup in `/etc/focus_blacklist.py`:\r\n\r\n```python\r\nimport re\r\n\r\ndef domain_ycombinator_com(dt):\r\n    # return dt.hour % 2 # every other hour\r\n    return False\r\n\r\ndef domain_reddit_com(dt):\r\n    # return dt.hour in (12, 21) # at noon-1pm, or from 9-10pm\r\n    return False\r\n    \r\ndef domain_facebook_com(dt):\r\n    return False\r\n\r\ndef default(domain, dt):\r\n    # do something with regular expressions here?\r\n    return True\r\n```\r\n\r\nThe format is simple; Just define a function named like the domain you\r\nwant to block, preceeded by \"domain_\".  Have it take a single datetime object\r\nand have it return True or False.  In the body, you can write whatever logic\r\nmakes the most sense for\r\nyou.  Maybe you want to write your own Pomodoro routine, or maybe you want to\r\nscrape your google calendar for exam dates, and block certain websites on those dates.\r\n\r\nFor sites without their own scheduler function, the default() function is called.\r\n\r\nThere's no need to restart Focus if you redefine your schedules.\r\n\r\n\r\nConfiguration\r\n=============\r\n\r\nFocus.py tries to start with a sensible configuration, but if you need to change\r\nit, edit `/etc/focus.json.conf`\r\n\r\n\r\nHow it works\r\n============\r\n\r\nFocus.py is, at its core, a DNS server.  By making it your primary nameserver,\r\nit receives all DNS lookup requests.  Based on the domain name being requested,\r\nit either responds with a \"fail ip\" address (blocked), or passes the request\r\non to your other nameservers (not blocked).  In both cases, Focus adjusts the TTL of each\r\nDNS response so that the service requesting the DNS lookup will do minimal\r\ncaching on the IP, allowing Focus's filtering rules to be more immediate.\r\n\r\n\r\nFAQ\r\n===\r\n\r\n- Q: I started Focus, but it's not blacklisting the site I picked.\r\n- A: Your browser may be caching that site's ip.  Give it a few minutes.\r\n\r\n- Q: Why do I need to start Focus with sudo?\r\n- A: Focus needs to listen on a privileged port as a DNS server.\r\n\r\n- Q: How do I stop Focus?\r\n- A: Focus writes its process id to /var/run/focus.py.pid.  Kill the process using this process id.\r\n","tagline":"Because the internet is distracting.","google":"UA-31477907-1","note":"Don't delete this file! It's used internally to help with page regeneration."}